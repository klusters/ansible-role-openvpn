{{ ansible_managed | comment }}

port {{ openvpn_port }}
proto {{ openvpn_protocol }}
dev tun
ca /etc/openvpn/server/ca.crt
cert /etc/openvpn/server/server.crt
key /etc/openvpn/server/server.key
dh /etc/openvpn/server/dh.pem
topology subnet
server {{ openvpn_server_subnet | ansible.utils.ipaddr('network') }} {{ openvpn_server_subnet | ansible.utils.ipaddr('netmask') }}
ifconfig-pool-persist ipp.txt
{% for dns in openvpn_dns %}
push "dhcp-option DNS {{ dns }}"
{% endfor %}
{% for network in openvpn_networks %}
push "route {{ network | ansible.utils.ipaddr('network') }} {{ network | ansible.utils.ipaddr('netmask') }}"
{% endfor %}
keepalive 10 120
cipher AES-256-CBC
user nobody
group {{ openvpn_group }}
persist-key
persist-tun
status openvpn-status.log
{% if openvpn_logfile != ''%}
log {{ openvpn_logfile }}
{% endif %}
verb 3
{% if openvpn_protocol == 'udp'%}
explicit-exit-notify 1
{% endif %}
remote-cert-eku "TLS Web Client Authentication"
comp-lzo
keysize 256
